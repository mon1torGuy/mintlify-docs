---
title: "Abuse and Fraud Prevention"
description: "This guide will help you prevent abuse and fraud in your application"
---


TypeAuth provides robust security features to protect your application from various types of fraud and abuse. This comprehensive suite of tools helps maintain the integrity of your authentication system and safeguard your users.

## Features Overview

### Global Rate Limiting

TypeAuth implements intelligent rate limiting across your entire application to prevent brute force attacks and abuse.

#### Configuration
```bash
curl --request POST \
  --url https://api.typeauth.com/{account_id}/abuse/create \
  --header 'Content-Type: application/json' \
  --data '{
  "name": "Global Rate Limit",
  "ratelimit": {
    "requests": "1m", // 1 million request
    "interval": "10m" // 10 minutes
  },
}'
```

#### Key Features
- **Flexible Window Sizes**: Configure time windows from seconds to days
- **Custom Throttling Rules**: Set different limits for specific endpoints or user types
- **IP-based Tracking**: Automatically detect and block suspicious IP patterns
- **Burst Protection**: Handle sudden spikes in traffic appropriately

### Disposable Email Detection

Prevent registration abuse by detecting and blocking disposable email addresses.

#### Usage
```bash
curl --request POST \
  --url https://api.typeauth.com/{account_id}/abuse/create \
  --header 'Content-Type: application/json' \
  --data '{
  "name": "Bademails",
  "blocklist": [
    "bademail.com"
  ],
  "exceptions": [
    "google.com", "microsoft.com"
  ],
  "checkPropertyName": "email",
  "checkLocations": "header"

}'
```

#### Features
- **Real-time Validation**: Check emails against constantly updated database
- **Custom Rules**: Add your own blocked/allowed domains
- **Comprehensive Database**: Access to 100,000+ known disposable email providers
- **API Integration**: Easy integration with existing email validation workflows

### Geo Sentry

GeoSentry protects your API endpoints by monitoring and detecting suspicious geographic access patterns. It works by tracking the physical locations where authentication tokens are used and can identify potentially compromised credentials when they're used from impossible locations in unrealistic timeframes - for instance, if the same token is used in New York and then Tokyo within minutes.
Here's a practical example: Imagine a customer's API token is suddenly used from their usual location in London, and then 30 minutes later, the same token attempts to access your API from Buenos Aires. Since it's physically impossible to travel this distance in such a short time, GeoSentry would flag this as suspicious activity and can either block the request, require additional verification, or alert your security team depending on your configuration. This early detection can prevent unauthorized access even if the attacker has obtained valid credentials.

#### Configuration
```bash
curl --request POST \
  --url https://api.typeauth.com/{account_id}/abuse/create \
  --header 'Content-Type: application/json' \
  --data '{
  "name": "Protect",
  "geoSentry: "Permissive"
}'
```

#### Capabilities
- **Token Geography Tracking**: Monitor authentication tokens across different locations
- **Velocity Checking**: Detect impossibly fast geographic movements
- **Risk Scoring**: Assign risk levels to different geographic patterns
- **Custom Rules**: Set specific policies for different regions

#### Profiles

	- **Permissive**: Allow
			maxSpeedKmH: 1200, // Fast commercial aircraft
			timeWindowMinutes: 120,
			minDistance: 1000, // Only check trips over 1000km
			riskLevel: "low",
			action: "monitor",
			allowUnknownLocations: true,
			tolerancePercentage: 20, // 20% margin of error

	STANDARD: {
		name: "Standard",
		config: {
			maxSpeedKmH: 1000, // Average commercial aircraft
			timeWindowMinutes: 90,
			minDistance: 500,
			riskLevel: "medium",
			action: "challenge",
			allowUnknownLocations: true,
			tolerancePercentage: 10,
		},
	},
	STRICT: {
		name: "Strict",
		config: {
			maxSpeedKmH: 800, // Conservative aircraft speed
			timeWindowMinutes: 60,
			minDistance: 300,
			riskLevel: "high",
			action: "block",
			allowUnknownLocations: false,
			tolerancePercentage: 5,
		},
	},
	REGIONAL: {
		name: "Regional",
		config: {
			maxSpeedKmH: 500, // Regional travel
			timeWindowMinutes: 45,
			minDistance: 100,
			riskLevel: "high",
			action: "block",
			allowedCountries: [], // Define per region
			allowUnknownLocations: false,
			tolerancePercentage: 5,
		},
	},

### Anomaly Detection

Advanced machine learning-based system to identify suspicious patterns and potential security threats.

#### Implementation
```bash
curl --request POST \
  --url https://api.typeauth.com/{account_id}/abuse/create \
  --header 'Content-Type: application/json' \
  --data '{
  "name": "Protect Anomaly",
  "anomalyDetection: "Permissive"
}'
```

#### Key Features
- **Behavioral Analysis**: Monitor and learn from normal user patterns
- **Multiple Detection Vectors**:
  - Login time patterns
  - Device fingerprinting
  - Network characteristics
  - User interaction patterns
- **Customizable Alerts**: Set different notification thresholds
- **Automatic Response**: Configure automated actions for detected anomalies

## Best Practices

1. **Start Conservative**: Begin with less restrictive settings and adjust based on your needs
2. **Monitor False Positives**: Regularly review blocked attempts for legitimate users
3. **Layer Security**: Use multiple features together for comprehensive protection
4. **Regular Updates**: Keep your TypeAuth installation updated for the latest security definitions

## Example Implementation

```typescript
import { TypeAuth } from 'typeauth';

const security = new TypeAuth({
  rateLimit: {
    maxRequests: 100,
    windowMs: 900000, // 15 minutes
  },
  emailSecurity: {
    blockDisposableEmails: true,
  },
  geoSentry: {
    enabled: true,
    notifyOnChange: true,
  },
  anomalyDetection: {
    enabled: true,
    sensitivity: 'medium',
  }
});

// Apply middleware to your application
app.use(security.protect());
```

## Error Handling

TypeAuth provides detailed error codes and messages for different types of security violations:

```typescript
try {
  await auth.validateRequest(request);
} catch (error) {
  if (error.code === 'RATE_LIMIT_EXCEEDED') {
    // Handle rate limiting
  } else if (error.code === 'SUSPICIOUS_LOCATION') {
    // Handle suspicious geographic activity
  } else if (error.code === 'DISPOSABLE_EMAIL') {
    // Handle disposable email attempt
  }
}
```

## Additional Resources

- [TypeAuth Security Best Practices Guide](https://docs.typeauth.dev/security)
- [API Reference](https://docs.typeauth.dev/api)
- [Configuration Options](https://docs.typeauth.dev/config)
- [Troubleshooting Guide](https://docs.typeauth.dev/troubleshooting)
